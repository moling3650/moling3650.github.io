var e=Object.defineProperty,s=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,n=(s,r,a)=>r in s?e(s,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[r]=a,p=(e,s)=>{var r={};for(var n in e)o.call(e,n)&&s.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&a)for(var n of a(e))s.indexOf(n)<0&&t.call(e,n)&&(r[n]=e[n]);return r};import{d as l,ap as c,aq as i,ar as f,am as u,V as m,J as d,c as h,e as g,w as y,T as v,z as b,as as O,n as w,S as j,E as x,L as P,at as E,au as k,av as _,a3 as C,i as T,_ as I}from"./index-5QPA0VXV.js";const S=l((q=((e,s)=>{for(var r in s||(s={}))o.call(s,r)&&n(e,r,s[r]);if(a)for(var r of a(s))t.call(s,r)&&n(e,r,s[r]);return e})({},{name:"wd-form",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),$={props:c,setup(e,{expose:s}){const{show:r}=i("wd-form-toast"),a=e,{children:o,linkChildren:t}=f(u);let n=m({});function l(e){e?n[e]="":Object.keys(n).forEach((e=>{n[e]=""}))}return t({props:a,errorMessages:n}),d((()=>a.model),(()=>{a.resetOnChange&&l()}),{immediate:!0,deep:!0}),s({validate:function(e){return s=this,t=null,c=function*(){const s=[];let t=!0;const c=[],i=function(){const e=C(a.rules),s=o.map((e=>e.prop));return Object.keys(e).forEach((r=>{s.includes(r)||delete e[r]})),o.forEach((s=>{P(s.prop)&&P(s.rules)&&s.rules.length&&(e[s.prop]?e[s.prop]=[...e[s.prop],...s.rules]:e[s.prop]=s.rules)})),e}(),f=x(e)?e:P(e)?[e]:[],u=f.length>0?f.reduce(((e,s)=>(i[s]&&(e[s]=i[s]),e)),{}):i;for(const e in u){const r=u[e],o=E(a.model,e);if(r&&r.length>0)for(const a of r){if(a.required&&(!P(o)||""===o)){s.push({prop:e,message:a.message}),t=!1;break}if(a.pattern&&!a.pattern.test(o)){s.push({prop:e,message:a.message}),t=!1;break}const r=a,{validator:n}=r,l=p(r,["validator"]);if(n){const r=n(o,l);k(r)?c.push(r.then((r=>{"string"==typeof r?(s.push({prop:e,message:r}),t=!1):"boolean"!=typeof r||r||(s.push({prop:e,message:a.message}),t=!1)})).catch((r=>{const o=P(r)?_(r)?r:r.message||a.message:a.message;s.push({prop:e,message:o}),t=!1}))):r||(s.push({prop:e,message:a.message}),t=!1)}}}return yield Promise.all(c),function(e){const s=o.map((e=>e.prop)).filter(Boolean),t=e.filter((e=>e.message&&s.includes(e.prop)));t.length&&(t.sort(((e,r)=>s.indexOf(e.prop)-s.indexOf(r.prop))),"toast"===a.errorType?r(t[0].message):"message"===a.errorType&&t.forEach((e=>{n[e.prop]=e.message})))}(s),t&&(f.length?f.forEach(l):l()),{valid:t,errors:s}},new Promise(((e,r)=>{var a=e=>{try{n(c.next(e))}catch(s){r(s)}},o=e=>{try{n(c.throw(e))}catch(s){r(s)}},n=s=>s.done?e(s.value):Promise.resolve(s.value).then(a,o);n((c=c.apply(s,t)).next())}));var s,t,c},reset:function(){l()}}),(e,s)=>{const r=T;return g(),h(r,{class:j(`wd-form ${e.customClass}`),style:w(e.customStyle)},{default:y((()=>[v(e.$slots,"default",{},void 0,!0),"toast"===a.errorType?(g(),h(O,{key:0,selector:"wd-form-toast"})):b("",!0)])),_:3},8,["class","style"])}}},s(q,r($))));var q,$;const z=I(S,[["__scopeId","data-v-e513a788"]]);export{z as _};
